<!DOCTYPE html>
<html lang="en">    
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Newyear Countdown</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    
    <div class="cursor-glow" aria-hidden="true"></div>
    <div id="themeOverlay" class="theme-overlay" aria-hidden="true"></div>

    <!-- Event selection modal (shown on page load) -->
    <div class="events-modal" id="eventsModal" role="dialog" aria-modal="true">
        <button id="showCustomEventsBtn" style="position:absolute;left:18px;top:18px;background:transparent;border:none;color:#fff;font-size:17px;cursor:pointer;font-weight:600;z-index:10;">üìã Danh s√°ch ƒë√£ th√™m</button>
        <div class="events-grid" id="eventsGrid">
            <!-- Th√™m s·ª± ki·ªán m·ªõi (t√πy ch·ªçn) -->
            <form id="addEventForm" style="width:100%;margin-bottom:18px;grid-column:span 2;display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:center;background:rgba(255,255,255,0.015);padding:10px 8px;border-radius:10px;">
                <input type="text" id="newEventName" placeholder="T√™n s·ª± ki·ªán" required style="flex:1 1 140px;min-width:90px;max-width:200px;padding:7px 9px;border-radius:4px;border:none;outline:none;font-size:14px;">
                <input type="date" id="newEventDate" required style="flex:1 1 110px;min-width:90px;max-width:160px;padding:7px 9px;border-radius:4px;border:none;outline:none;font-size:14px;">
                <input type="time" id="newEventTime" required style="flex:1 1 85px;min-width:66px;max-width:120px;padding:7px 9px;border-radius:4px;border:none;outline:none;font-size:14px;">
                <button type="submit" style="padding:7px 16px;background:var(--accent,#00c3ff);color:#fff;border:none;border-radius:8px;font-weight:600;font-size:14px;cursor:pointer;">+ Th√™m</button>
            </form>

            <button id="closeModal" aria-label="Close selection" style="position:absolute;right:18px;top:18px;background:transparent;border:none;color:#fff;font-size:26px;cursor:pointer;">&times;</button>
            <div class="event-card" data-id="christmas" data-datetime="2025-12-25T00:00:00">
                <div class="event-emoji">üéÑ</div>
                <div class="event-title">Christmas</div>
                <div class="event-sub">25/12/2025 ‚Äî 00:00:00</div>
                <div class="event-accent"></div>
            </div>
            <div class="event-card" data-id="newyear" data-datetime="2026-01-01T00:00:00">
                <div class="event-emoji">üéÜ</div>
                <div class="event-title">New Year</div>
                <div class="event-sub">1/1/2026 ‚Äî 00:00:00</div>
                <div class="event-accent"></div>
            </div>
            <div class="event-card" data-id="chinese" data-datetime="2026-02-17T00:00:00">
                <div class="event-emoji">üßß</div>
                <div class="event-title">Chinese New Year</div>
                <div class="event-sub">17/2/2026 ‚Äî 00:00:00</div>
                <div class="event-accent"></div>
            </div>
            <div class="event-card" data-id="exam" data-datetime="2026-06-11T07:30:00">
                <div class="event-emoji">üë©‚Äçüéì</div>
                <div class="event-title">K√¨ thi THPT Qu·ªëc Gia</div>
                <div class="event-sub">11/6/2026 ‚Äî 07:30:00</div>
                <div class="event-accent"></div>
            </div>
        </div>
    </div>


    <div class="center">
        <button class="live-btn" id="liveBtn">
            <span class="dot"></span>
            <span class="live-text">Live Countdown Active</span>
        </button>
    </div>
    <div>
        <video autoplay loop muted>
            <source type="video/mp4" src="1222.mp4">
            <source type="video/webm" src="1222.mp4">
        </video>
    </div>
    <div class="text_main">
        <div class="white">K√¨ thi</div>
        <div class="gradient">THPT Qu·ªëc Gia</div>
        <div class="gradient">2026</div>
    </div>
    <div class="center"><p>Every second brings us closer to the most magical celebration of the year</p></div>  
    <div class="countdown">
    <div class="time-box">
        <span class="number" id="days">03</span>
        <span class="label">DAYS</span>
    </div>

    <span class="colon">:</span>

    <div class="time-box">
        <span class="number" id="hours">00</span>
        <span class="label">HOURS</span>
    </div>

    <span class="colon">:</span>

    <div class="time-box">
        <span class="number" id="minutes">36</span>
        <span class="label">MINUTES</span>
    </div>

    <span class="colon">:</span>

    <div class="time-box">
        <span class="number" id="seconds">09</span>
        <span class="label">SECONDS</span>
    </div>
</div>
    <div class="center">
        <button class="live-btn" id="liveInfo">‚Äî</button>
    </div>
    <button class="change-btn" id="changeBtn" title="Change event">Change event</button>
    <script>
    // ======= TH√äM S·ª∞ KI·ªÜN M·ªöI =======
    function setupAddEventForm() {
      const addEventForm = document.getElementById('addEventForm');
      if(!addEventForm) return;
      addEventForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const name = document.getElementById('newEventName').value.trim();
        const date = document.getElementById('newEventDate').value;
        const time = document.getElementById('newEventTime').value || '00:00';
        if(!name || !date) return;
        const eventsGrid = document.getElementById('eventsGrid');
        const dtString = date + 'T' + (time.length === 5 ? (time+':00') : time);
        // T·∫°o id ri√™ng cho custom event, k√®m t√™n v√† th·ªùi ƒëi·ªÉm
        const id = 'custom' + Math.random().toString().slice(2,8);
        // Th√™m card m·ªõi
        const card = document.createElement('div');
        card.className = 'event-card';
        card.dataset.id = id;
        card.dataset.datetime = dtString;
        card.innerHTML = `<div class="event-emoji">üìÖ</div>
          <div class="event-title">${name}</div>
          <div class="event-sub">${date.split('-').reverse().join('/')} ‚Äî ${time+':00'}</div>
          <div class="event-accent"></div>`;
        eventsGrid.appendChild(card);
        // L∆∞u v√†o m·∫£ng customEvents trong localStorage
        let customEvents = [];
        try { customEvents = JSON.parse(localStorage.getItem('customEvents')) || []; }catch(e){}
        customEvents.push({id, name, datetime: dtString});
        try { localStorage.setItem('customEvents', JSON.stringify(customEvents)); }catch(e){}
        // T·ª± ƒë·ªông ch·ªçn s·ª± ki·ªán lu√¥n
        card.click();
        // Reset form
        addEventForm.reset();
      });
      // Khi load l·∫°i, show c√°c custom event c≈©
      try {
        let customs = JSON.parse(localStorage.getItem('customEvents'))||[];
        customs.forEach(ev=>{
          const card = document.createElement('div');
          card.className = 'event-card';
          card.dataset.id = ev.id;
          card.dataset.datetime = ev.datetime;
          const onlyDate = ev.datetime.split('T')[0];
          const onlyTime = ev.datetime.split('T')[1];
          card.innerHTML = `<div class="event-emoji">üìÖ</div>\n<div class="event-title">${ev.name}</div>\n<div class="event-sub">${onlyDate.split('-').reverse().join('/')} ‚Äî ${onlyTime}</div>\n<div class="event-accent"></div>`;
          eventsGrid.appendChild(card);
        });
      }catch(e){}
    }
    // G·ªçi function n√†y ngay khi script ch·∫°y
    setupAddEventForm();
    (function(){
        let intervalId = null;
        let targetDate = Date.now() + 1000 * 60 * 60 * 24 * 3; // fallback

        const modal = document.getElementById('eventsModal');
        const overlay = document.getElementById('themeOverlay');
        const cards = document.querySelectorAll('.event-card');
        const whiteEl = document.querySelector('.white');
        const gradientEls = document.querySelectorAll('.gradient');
        const liveInfo = document.getElementById('liveInfo');
        const liveBtnText = document.querySelector('.live-text');
        const closeBtn = document.getElementById('closeModal');
        const changeBtn = document.getElementById('changeBtn');

        let effects = { intervals: [], timeouts: [], elements: [] };

        function clearEffects(){
            // clear intervals/timeouts
            effects.intervals.forEach(id=> clearInterval(id));
            effects.timeouts.forEach(id=> clearTimeout(id));
            effects.intervals = [];
            effects.timeouts = [];
            // remove created elements
            effects.elements.forEach(el=> el.remove());
            effects.elements = [];
            // remove exam pulse
            document.querySelectorAll('.time-box').forEach(tb=> tb.classList.remove('exam-pulse'));
        }

        function startSnow(){
            clearEffects();
            const count = 40;
            const w = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
            for(let i=0;i<count;i++){
                const s = document.createElement('div');
                s.className = 'snowflake';
                const size = 4 + Math.random()*8;
                s.style.width = size+'px'; s.style.height = size+'px';
                s.style.left = (Math.random()*100)+'%';
                s.style.opacity = 0.6 + Math.random()*0.4;
                const dur = 6 + Math.random()*10;
                s.style.animationDuration = dur+'s';
                s.style.transform = 'translateY(0)';
                overlay.appendChild(s);
                effects.elements.push(s);
            }
        }

        function startFireworks(){
            clearEffects();
            const colors = ['#ffd166','#ff6b6b','#ffd6a5','#9bf6ff','#ff9f1c'];
            const spawn = ()=>{
                const cx = (20 + Math.random()*60);
                const cy = (20 + Math.random()*40);
                const num = 22 + Math.floor(Math.random()*12);
                for(let i=0;i<num;i++){
                    const p = document.createElement('div');
                    p.className = 'fw-particle';
                    p.style.left = cx + '%'; p.style.top = cy + '%';
                    const c = colors[Math.floor(Math.random()*colors.length)];
                    p.style.background = c;
                    overlay.appendChild(p);
                    effects.elements.push(p);
                    // random vector
                    const angle = Math.random()*Math.PI*2;
                    const dist = 40 + Math.random()*80;
                    // force layout then animate via transform+opacity
                    requestAnimationFrame(()=>{
                        p.style.transition = 'transform 800ms cubic-bezier(.2,.8,.2,1), opacity 800ms linear';
                        p.style.transform = `translate(${Math.cos(angle)*dist}px, ${Math.sin(angle)*dist}px)`;
                        p.style.opacity = '0';
                    });
                    // cleanup
                    effects.timeouts.push(setTimeout(()=>{ p.remove(); }, 900));
                }
            };
            spawn();
            effects.intervals.push(setInterval(spawn, 900));
        }

        function startLanterns(){
            clearEffects();
            const spawn = ()=>{
                const ln = document.createElement('div');
                ln.className = 'lantern';
                ln.style.left = (5 + Math.random()*90)+'%';
                const dur = 10 + Math.random()*14;
                ln.style.animationDuration = dur+'s';
                overlay.appendChild(ln);
                effects.elements.push(ln);
                ln.addEventListener('animationend', ()=>{ ln.remove(); });
            };
            spawn();
            effects.intervals.push(setInterval(spawn, 900));
        }

        function startCaps(){
            clearEffects();
            const spawn = ()=>{
                const c = document.createElement('div');
                c.className = 'cap cap-fall';
                c.textContent = 'üë©‚Äçüéì';
                c.style.left = (5 + Math.random()*90)+'%';
                const dur = 6 + Math.random()*6; // fall duration
                c.style.animationDuration = dur+'s';
                c.style.fontSize = (16 + Math.random()*14) + 'px';
                overlay.appendChild(c);
                effects.elements.push(c);
                c.addEventListener('animationend', ()=>{ c.remove(); });
            };
            // spawn a few immediately
            for(let i=0;i<6;i++){ setTimeout(spawn, i*180); }
            effects.intervals.push(setInterval(spawn, 900));
        }

        function startExam(){
            clearEffects();
            document.querySelectorAll('.time-box').forEach(tb=> tb.classList.add('exam-pulse'));
            // subtle periodic pulse (toggle class to strengthen effect)
            const id = setInterval(()=>{
                document.querySelectorAll('.time-box').forEach(tb=> tb.classList.toggle('exam-pulse'));
            }, 1500);
            effects.intervals.push(id);
        }

        function startEffectFor(id){
            if(!overlay) return;
            overlay.innerHTML = '';
            if(id === 'christmas') startSnow();
            else if(id === 'newyear') startFireworks();
            else if(id === 'chinese') startFireworks();
            else if(id === 'exam') { startCaps(); startExam(); }
        }

        function applySelection(id, dt){
            document.body.dataset.theme = id;
            // update headline and subhead ‚Äî show full title in main heading
            const title = document.querySelector('.event-card[data-id="'+id+'"] .event-title').textContent;
            whiteEl.textContent = title || '';
            // put year into the last .gradient element and clear others
            gradientEls.forEach((el, idx)=>{
                if(idx === gradientEls.length - 1) el.textContent = new Date(dt).getFullYear();
                else el.textContent = '';
            });
            // update live info
            liveInfo.textContent = dt.replace('T',' ');
            if(liveBtnText) liveBtnText.textContent = 'Live ‚Äî '+title;
            // mark selected card
            cards.forEach(c=> c.classList.toggle('selected', c.dataset.id === id));
            // persist
            try{ localStorage.setItem('selectedEvent', JSON.stringify({id, dt})); }catch(e){}
            targetDate = new Date(dt).getTime();
            startCountdown();
            // start visual effect for theme
            clearEffects();
            startEffectFor(id);
            // set themed video: newyear and chinese use 1222(1).mp4; others use id.mp4
            const videoEl = document.querySelector('video');
            if(videoEl){
                const mp4 = videoEl.querySelector('source[type="video/mp4"]');
                const webm = videoEl.querySelector('source[type="video/webm"]');
                let newMp4 = id + '.mp4';
                let newWebm = id + '.webm';
                if(id === 'newyear' || id === 'chinese'){
                    newMp4 = '1222(1).mp4';
                    newWebm = '1222(1).webm';
                }
                mp4.src = newMp4;
                webm.src = newWebm;
                videoEl.load();
                // show video when loadedmetadata; hide on error
                videoEl.style.display = 'none';
                const onLoaded = function(){ videoEl.style.display = ''; cleanup(); };
                const onError = function(){ videoEl.style.display = 'none'; cleanup(); };
                function cleanup(){ videoEl.removeEventListener('loadedmetadata', onLoaded); videoEl.removeEventListener('error', onError); }
                videoEl.addEventListener('loadedmetadata', onLoaded, {once:true});
                videoEl.addEventListener('error', onError, {once:true});
            }
        }

        function startCountdown(){
            if(intervalId) clearInterval(intervalId);
            function update(){
                const now = Date.now();
                const diff = targetDate - now;
                if(diff <= 0){ clearInterval(intervalId); return; }
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
                const minutes = Math.floor((diff / (1000 * 60)) % 60);
                const seconds = Math.floor((diff / 1000) % 60);
                document.getElementById('days').textContent = String(days).padStart(2,'0');
                document.getElementById('hours').textContent = String(hours).padStart(2,'0');
                document.getElementById('minutes').textContent = String(minutes).padStart(2,'0');
                document.getElementById('seconds').textContent = String(seconds).padStart(2,'0');
            }
            update();
            intervalId = setInterval(update, 1000);
        }

        // load saved selection
        try{
            const saved = JSON.parse(localStorage.getItem('selectedEvent'));
            if(saved && saved.id && saved.dt){ applySelection(saved.id, saved.dt); modal.style.display='none'; }
            else modal.style.display='flex';
        }catch(e){ modal.style.display='grid'; }

        cards.forEach(card => {
            card.addEventListener('click', ()=>{
                const id = card.dataset.id;
                const dt = card.dataset.datetime;
                applySelection(id, dt);
                modal.style.display = 'none';
            });
        });

        // allow close without selection (keeps fallback)
        if(closeBtn){ closeBtn.addEventListener('click', ()=>{ modal.style.display='none'; }); }

        // open modal via change button
        if(changeBtn){ changeBtn.addEventListener('click', ()=>{ modal.style.display='flex'; modal.setAttribute('aria-hidden','false'); }); }

    })();
    </script>

<script>
// Cursor-follow red glow: update CSS variables --x and --y
(function(){
    const root = document.documentElement;
    const glow = document.querySelector('.cursor-glow');
    if(!glow) return;

    let raf = null;
    function setPos(x,y){
        root.style.setProperty('--x', x + 'px');
        root.style.setProperty('--y', y + 'px');
    }

    function onMove(e){
        const x = e.clientX || (e.touches && e.touches[0].clientX) || 0;
        const y = e.clientY || (e.touches && e.touches[0].clientY) || 0;
        if(raf) cancelAnimationFrame(raf);
        raf = requestAnimationFrame(()=>{
            setPos(x,y);
            glow.style.opacity = '1';
        });
    }

    function onLeave(){
        if(raf) cancelAnimationFrame(raf);
        glow.style.opacity = '0';
    }

    document.addEventListener('mousemove', onMove, {passive: true});
    document.addEventListener('touchmove', onMove, {passive: true});
    document.addEventListener('mouseleave', onLeave);
    document.addEventListener('mouseout', (e)=>{ if(!e.relatedTarget) onLeave(); });
    document.addEventListener('touchstart', ()=>{ glow.style.display = 'none'; }, {passive:true});
})();
</script>

</body>
</html>
